{% extends "base.html" %}

{% block content %}
<div class="container-fluid">
    <h2 class="text-center">Workout Plan</h2>

    <!-- Filters for Exercises -->
    <div class="filters dropdown-group">
        <h4>Filter Exercises</h4>
        <form id="filters-form" class="row gx-4 gy-3">
            {% for filter_name, filter_options in filters.items() %}
            <div class="col-lg-3 col-md-4 col-sm-6">
                <label for="{{ filter_name }}" class="form-label">{{ filter_name }}</label>
                <select id="{{ filter_name }}" class="form-select">
                    <option value="">All</option>
                    {% for option in filter_options %}
                    <option value="{{ option }}">{{ option }}</option>
                    {% endfor %}
                </select>
            </div>
            {% endfor %}
        </form>        
    </div>

    <!-- Routine and Exercise Dropdowns -->
    <div class="row gx-4 gy-3 mt-3">
        <div class="col-lg-3 col-md-4 col-sm-6">
            <label for="routine" class="form-label">Routine</label>
            <select id="routine" class="form-select wide-input">
                {% for split_type, routines in routineOptions.items() %}
                <optgroup label="{{ split_type }}">
                    {% for routine in routines %}
                    <option value="{{ routine }}">{{ routine }}</option>
                    {% endfor %}
                </optgroup>
                {% endfor %}
            </select>
        </div>
        <div class="col-lg-3 col-md-4 col-sm-6">
            <label for="exercise" class="form-label">Exercise</label>
            <select id="exercise" class="form-select filter-dropdown wide-input">
                {% for exercise in exercises %}
                {% if exercise %}
                <option value="{{ exercise }}">{{ exercise }}</option>
                {% endif %}
                {% endfor %}
            </select>
        </div>
    </div>

    <!-- Numeric Inputs -->
    <form id="add-exercise-form">
        <div class="row gx-4 gy-3 mt-3">
            <div class="col-lg-1 col-md-2">
                <label for="sets" class="form-label">Sets</label>
                <input type="number" id="sets" class="form-control small-input" min="1" value="1">
            </div>
            <div class="col-lg-1 col-md-2">
                <label for="rir" class="form-label">RIR</label>
                <input type="number" id="rir" class="form-control small-input" min="0" value="2">
            </div>
            <div class="col-lg-1 col-md-2">
                <label for="min_rep_range" class="form-label">Min Rep</label>
                <input type="number" id="min_rep_range" class="form-control small-input" min="1" value="3">
            </div>
            <div class="col-lg-1 col-md-2">
                <label for="max_rep_range" class="form-label">Max Rep</label>
                <input type="number" id="max_rep_range" class="form-control small-input" min="1" value="5">
            </div>
            <div class="col-lg-1 col-md-2">
                <label for="weight" class="form-label">Weight</label>
                <input type="number" id="weight" class="form-control small-input" min="0" value="100">
            </div>
        </div>

        <!-- Buttons -->
        <div class="row gx-4 gy-3 mt-3">
            <div class="col-lg-2 col-md-3">
                <button id="add-exercise-btn" type="submit" class="btn btn-success w-100">Add Exercise</button>
            </div>
            <div class="col-lg-2 col-md-3">
                <button id="filter-btn" class="btn btn-primary w-100">Apply Filters</button>
            </div>
        </div>
    </form>

    <!-- Display the Workout Plan -->
    <div class="workout-plan table-container mt-4">
        <h2 class="text-center" style="font-weight: bold; font-size: 1.8rem;">Your Workout Plan</h2>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Routine</th>
                    <th>Exercise</th>
                    <th>Primary Muscle Group</th>
                    <th>Secondary Muscle Group</th>
                    <th>Tertiary Muscle Group</th>
                    <th>Sets</th>
                    <th>Min Rep Range</th>
                    <th>Max Rep Range</th>
                    <th>RIR</th>
                    <th>Weight</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="workout-plan-table-body">
                <!-- Dynamically populated via JavaScript -->
            </tbody>
        </table>
    </div>

    <!-- Export Button -->
    <div class="export-section mt-3 text-center">
        <button class="btn btn-primary" onclick="exportToExcel()">Export to Excel</button>
    </div>
</div>
{% endblock %}
